#Задание

Склонируйте код из репозитория: `git clone https://github.com/shri-msk-2016/task3.git`, перейдите в директорию проекта `cd task3`.

Выполните `npm install`, а затем `npm start` и откройте приложение в браузере (<http://localhost:8080>).

Приложение позволяет добавлять и редактировать данные студентов ШРИ (ФИО, ссылку на фотографию и краткую информацию). Для работы в офлайне оно использует ServiceWorker, позволяя при этом, как минимум, просматривать данные студентов.

Однако при реализации были допущены несколько ошибок:

* Без подключения к серверу приложение не работает.
* Не всегда обновляется список студентов после добавления нового.

Найдите и исправьте ошибки. В качестве дополнительного задания вы можете реализовать добавление студентов в офлайне с последующей синхронизацией. При выполнении обратите внимание на способы определения режима «онлайн/офлайн».

Результат пришлите в виде ссылки на https://github.com

##Что мы проверяем этим заданием?

Мы хотим проверить вашу способность разобраться в незнакомом коде и/или API. Также с помощью этого задания мы оценим ваш навык отладки. Поэтому прокомментируйте, пожалуйста, в коде или текстовом файле README ход ваших мыслей — какие ошибки и как вы нашли, почему они возникли и какие способы исправления существуют. Мы не ограничиваем вас в использовании сторонних инструментов и библиотек, однако при их использовании также ожидаем комментариев, в которых вы расскажете, зачем и почему было использовано то или иное средство.

#Исправление ошибок
Сначала исправим ошибку в `worker.js` (лишняя ";" на 36 сроке).
Далее, для кеширования файлов (`index.html`, `index.css` и `index.js`) ServiceWorker должен иметь область видимости "/".
Этого можно добиться [двумя способами](https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API/Using_Service_Workers#Why_is_my_service_worker_failing_to_register):
* разместить `worker.js`  в корне клиента
* отправлять заголовок `Service-Worker-Allowed: /`

Выберем второй вариант, чтобы сохранить структуру расположения файлов в проекте. Также исправим пути до файлов в `worker.js`.

Приложение стало запускаться при отсутствии подключения, но появились пробелмы с загрузкой аватарок.
Это можно исправить редактированием функции `getFromCache` в `worker.js`: передавать `request` в `Promise.reject`,
если соответствующий `response` не найден в кеше.

Проблема с обновлением списка после добавления возникает из-за того, что в обработка запроса используется следующая констркуция:
```javascript
return event.respondWith(
    Promise.race([
        fetchAndPutToCache(event.request),
        getFromCache(event.request)
    ])
);
```
При этом результат может быть возвращен из кеша. Чтобы такого не происходило, изменим код следующим образом:
```javascript
return event.respondWith(fetchAndPutToCache(event.request));
```
Теперь проблемы решены.